============================= test session starts ==============================
platform linux -- Python 3.12.11, pytest-8.4.2, pluggy-1.6.0 -- /usr/bin/python3
cachedir: .pytest_cache
hypothesis profile 'default'
rootdir: /content
plugins: hypothesis-6.140.2, typeguard-4.4.4, langsmith-0.4.28, anyio-4.10.0
collected 6 items

test_batch_invariance.py::test_matmul[matmul_batched] FAILED             [ 16%]
test_batch_invariance.py::test_matmul[matmul_rowwise] PASSED             [ 33%]
test_batch_invariance.py::test_rmsnorm[rmsnorm_batched] FAILED           [ 50%]
test_batch_invariance.py::test_rmsnorm[rmsnorm_rowwise] PASSED           [ 66%]
test_batch_invariance.py::test_attn[attn_batched] FAILED                 [ 83%]
test_batch_invariance.py::test_attn[attn_rowwise] PASSED                 [100%]

=================================== FAILURES ===================================
_________________________ test_matmul[matmul_batched] __________________________

matmul_fn = <function matmul_batched at 0x7c9717198220>

    @pytest.mark.parametrize("matmul_fn", [matmul_batched, matmul_rowwise])
>   @given(inputs=matmul_strategy())
                   ^^^^^^^^^^^^

test_batch_invariance.py:63:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

inputs = (tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
         1., 1., 1., 1., 1., 1., 1.,...2662804933],
        [71.16367082662804933, 71.16367082662804933]], device='cuda:0',
       dtype=torch.float64), 0, 1)
matmul_fn = <function matmul_batched at 0x7c9717198220>

    @pytest.mark.parametrize("matmul_fn", [matmul_batched, matmul_rowwise])
    @given(inputs=matmul_strategy())
    @settings(deadline=None, max_examples=1000)
    def test_matmul(inputs, matmul_fn):
        a, b, m, n = inputs

        # Property: slicing before vs after batch matmul yields same first row
        out1 = matmul_fn(a[m:n], b)    # (n-m,D) @ (D,N) -> (n-m,N)
        out2 = matmul_fn(a, b)[m:n]    # (B,D) @ (D,N) -> (B,N) then slice -> (n-m,N)

        diff = torch.abs(out1 - out2).max()

        # guard against nan, inf, etc.
        assume(torch.isfinite(diff))

        diff = diff.item()
        torch.set_printoptions(precision=17)
        note(f"diff: {diff}\nout1: {out1}\nout2: {out2}")

        # assert diff
>       assert diff == 0
E       assert 4.547473508864641e-13 == 0
E       Falsifying example: test_matmul(
E           matmul_fn=matmul_batched,
E           inputs=(tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                     1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],
E                    [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                     1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]], device='cuda:0',
E                   dtype=torch.float64),
E            tensor([[71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933],
E                    [71.16367082662804933, 71.16367082662804933]], device='cuda:0',
E                   dtype=torch.float64),
E            0,
E            1),
E       )
E       diff: 4.547473508864641e-13
E       out1: tensor([[2134.91012479884102504, 2134.91012479884102504]], device='cuda:0',
E              dtype=torch.float64)
E       out2: tensor([[2134.91012479884147979, 2134.91012479884147979]], device='cuda:0',
E              dtype=torch.float64)

test_batch_invariance.py:82: AssertionError
________________________ test_rmsnorm[rmsnorm_batched] _________________________

rmsnorm_fn = <function rmsnorm_batched at 0x7c9633ed00e0>

    @pytest.mark.parametrize("rmsnorm_fn", [rmsnorm_batched, rmsnorm_rowwise])
>   @given(inputs=rmsnorm_strategy())
                   ^^^^^^^^^^^^^

test_batch_invariance.py:133:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

inputs = (tensor([[  3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
           3.87568740512597287,   3.875...., 1.,
        1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:0',
       dtype=torch.float64), 2, 3)
rmsnorm_fn = <function rmsnorm_batched at 0x7c9633ed00e0>

    @pytest.mark.parametrize("rmsnorm_fn", [rmsnorm_batched, rmsnorm_rowwise])
    @given(inputs=rmsnorm_strategy())
    @settings(deadline=None, max_examples=1000)
    def test_rmsnorm(inputs, rmsnorm_fn):
        x, gamma, m, n = inputs

        # Property: slicing before vs after batch matmul yields same first row
        out1 = rmsnorm_fn(x[m:n], gamma)    # (n-m,D) @ (D,N) -> (n-m,N)
        out2 = rmsnorm_fn(x, gamma)[m:n]    # (B,D) @ (D,N) -> (B,N) then slice -> (n-m,N)

        diff = torch.abs(out1 - out2).max()

        # guard against nan, inf, etc.
        assume(torch.isfinite(diff))

        diff = diff.item()
        torch.set_printoptions(precision=17)
        note(f"diff: {diff}\nout1: {out1}\nout2: {out2}")

        # assert diff
>       assert diff == 0
E       assert 3.552713678800501e-15 == 0
E       Falsifying example: test_rmsnorm(
E           rmsnorm_fn=rmsnorm_batched,
E           inputs=(tensor([[  3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287],
E                    [  3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287],
E                    [  3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287, 224.00000000000000000,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
E                       3.87568740512597287]], device='cuda:0', dtype=torch.float64),
E            tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
E                    1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:0',
E                   dtype=torch.float64),
E            2,
E            3),
E       )
E       diff: 3.552713678800501e-15
E       out1: tensor([[ 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647, 14.64131943281874548,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
E                 0.25332668446518647]], device='cuda:0', dtype=torch.float64)
E       out2: tensor([[ 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641, 14.64131943281874193,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
E                 0.25332668446518641]], device='cuda:0', dtype=torch.float64)

test_batch_invariance.py:152: AssertionError
___________________________ test_attn[attn_batched] ____________________________

attn_fn = <function attn_batched at 0x7c9633ed0a40>

    @pytest.mark.parametrize("attn_fn", [attn_batched, attn_rowwise])
>   @given(inputs=attn_strategy())
                   ^^^^^^^^^^

test_batch_invariance.py:221:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

inputs = (tensor([[[[0., 0.],
          [0., 0.],
          [0., 0.],
          [0., 0.],
          [0., 0.],
          [0., 0....  [1., 1.],
          [1., 1.],
          [1., 1.],
          [1., 1.]]]], device='cuda:0', dtype=torch.float64), 0, 1)
attn_fn = <function attn_batched at 0x7c9633ed0a40>

    @pytest.mark.parametrize("attn_fn", [attn_batched, attn_rowwise])
    @given(inputs=attn_strategy())
    @settings(deadline=None, max_examples=1000)
    def test_attn(inputs, attn_fn):
        Q, K, V, m, n = inputs

        out1 = attn_fn(Q[m:n], K[m:n], V[m:n])
        out2 = attn_fn(Q, K, V)[m:n]

        diff = torch.abs(out1 - out2).max()

        # guard against nan, inf, etc.
        assume(torch.isfinite(diff))

        diff = diff.item()
        torch.set_printoptions(precision=17)
        note(f"diff: {diff}\nout1: {out1}\nout2: {out2}")

        # assert diff
>       assert diff == 0
E       assert 3.6637359812630166e-15 == 0
E       Falsifying example: test_attn(
E           attn_fn=attn_batched,
E           inputs=(tensor([[[[0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.]]],
E
E
E                    [[[0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.]]]], device='cuda:0', dtype=torch.float64),
E            tensor([[[[0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.]]],
E
E
E                    [[[0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.],
E                      [0., 0.]]]], device='cuda:0', dtype=torch.float64),
E            tensor([[[[1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.]]],
E
E
E                    [[[1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.],
E                      [1., 1.]]]], device='cuda:0', dtype=torch.float64),
E            0,
E            1),
E       )
E       diff: 3.6637359812630166e-15
E       out1: tensor([[[[0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989],
E                 [0.99999999999999989, 0.99999999999999989]]]], device='cuda:0',
E              dtype=torch.float64)
E       out2: tensor([[[[1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355],
E                 [1.00000000000000355, 1.00000000000000355]]]], device='cuda:0',
E              dtype=torch.float64)

test_batch_invariance.py:239: AssertionError
=========================== short test summary info ============================
FAILED test_batch_invariance.py::test_matmul[matmul_batched] - assert 4.547473508864641e-13 == 0
Falsifying example: test_matmul(
    matmul_fn=matmul_batched,
    inputs=(tensor([[1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
              1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.],
             [1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
              1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.]], device='cuda:0',
            dtype=torch.float64),
     tensor([[71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933],
             [71.16367082662804933, 71.16367082662804933]], device='cuda:0',
            dtype=torch.float64),
     0,
     1),
)
diff: 4.547473508864641e-13
out1: tensor([[2134.91012479884102504, 2134.91012479884102504]], device='cuda:0',
       dtype=torch.float64)
out2: tensor([[2134.91012479884147979, 2134.91012479884147979]], device='cuda:0',
       dtype=torch.float64)
FAILED test_batch_invariance.py::test_rmsnorm[rmsnorm_batched] - assert 3.552713678800501e-15 == 0
Falsifying example: test_rmsnorm(
    rmsnorm_fn=rmsnorm_batched,
    inputs=(tensor([[  3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287],
             [  3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287],
             [  3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287, 224.00000000000000000,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287,   3.87568740512597287,   3.87568740512597287,
                3.87568740512597287]], device='cuda:0', dtype=torch.float64),
     tensor([1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.,
             1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1., 1.], device='cuda:0',
            dtype=torch.float64),
     2,
     3),
)
diff: 3.552713678800501e-15
out1: tensor([[ 0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647, 14.64131943281874548,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647,  0.25332668446518647,  0.25332668446518647,
          0.25332668446518647]], device='cuda:0', dtype=torch.float64)
out2: tensor([[ 0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641, 14.64131943281874193,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641,  0.25332668446518641,  0.25332668446518641,
          0.25332668446518641]], device='cuda:0', dtype=torch.float64)
FAILED test_batch_invariance.py::test_attn[attn_batched] - assert 3.6637359812630166e-15 == 0
Falsifying example: test_attn(
    attn_fn=attn_batched,
    inputs=(tensor([[[[0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.]]],


             [[[0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.]]]], device='cuda:0', dtype=torch.float64),
     tensor([[[[0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.]]],


             [[[0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.],
               [0., 0.]]]], device='cuda:0', dtype=torch.float64),
     tensor([[[[1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.]]],


             [[[1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.],
               [1., 1.]]]], device='cuda:0', dtype=torch.float64),
     0,
     1),
)
diff: 3.6637359812630166e-15
out1: tensor([[[[0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989],
          [0.99999999999999989, 0.99999999999999989]]]], device='cuda:0',
       dtype=torch.float64)
out2: tensor([[[[1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355],
          [1.00000000000000355, 1.00000000000000355]]]], device='cuda:0',
       dtype=torch.float64)
=================== 3 failed, 3 passed in 703.57s (0:11:43) ====================